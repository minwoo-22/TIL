# Java의 메모리 구조
<br>
<img src=https://user-images.githubusercontent.com/81568304/170813578-d05ae044-1dd6-4cb6-9ee0-9653f5193514.png>


### 메모리 구조
<p>
모든 자바 프로그램은 자바 가상 머신(JVM)을 통해서 실행됩니다.
</p>
<p>
자바 프로그램이 실행되면, JVM은 운영 체제로부터 해당 프로그램을 수행할 수 있도록 필요한 메모리를 할당받습니다.
</p>
<br>
<p>
이렇게 할당받은 메모리를 JVM은 용도에 따라 다음과 같이 구분하여 관리합니다.
</p>
<img src="https://user-images.githubusercontent.com/81568304/170813222-eed01062-db0f-452f-a148-903932db3da9.png">
<br>

---------------------------
### 메소드(method) 영역
<p>
JVM이 시작할 때 생성되고 모든 스레드가 공유하는 여역입니다. 메소드 영역은 자바 프로그램에서 사용되는 클래스에 대한 정보와 함께 클래스 변수 (static variable)가 저장되는 영역입니다.
</p>
<p>
JVM은 자바 프로그램에서 특정 클래스가 사용되면 해당 클래스의 클래스 파일(*.class)를 읽어들여, 해당 클래스에 대한 정보를 메소드 영역에 저장합니다.
</p>
<p>
또한 JVM의 다른 메모리 영역에서 해당 정보에 대한 요청이 오면, 실제 물리 메로리 주소로 변환해서 전달해줍니다. 기초 역할을 하므로 JVM 구동 시작 시에 생성이 되며, 종료 시까지 유지되는 공통 영역입니다.
</p>
<br>

---
### 힙(heap) 영역
<p>
힙(heap) 영역은 자바 프로그램에서 사용되는 모든 인스턴스 변수가 저장되는 영역입니다. JVM은 자바 프로그램에서 new 키워드를 사용하여 인스턴스가 생성되면, 해당 인스턴스의 정보를 힙 영역에 저장합니다.
힙 영역은 메모리의 낮은 주소에서 높은 주소의 방향으로 할당됩니다.
</p>
<p>
힙 영역은 JVM당 하나만 생성이 되고, 해당 영역이 가진 데이터는 모든 Java Stack 영역에서 참조되어, Thread간 공유가 됩니다. Heap 영역이 가득 차게 되면 OutOfMemoryError를 발생시키게 됩니다.
</p>
<br>

---
### 스택(stack) 영역
<p>
스택(stack) 영역은 각 Thread 별로 따로 할당되는 역영이며, 자바 프로그램에서 메소드가 호출될 때 메소드의 스택 프레임이 저장되는 영역입니다.
</p>
<p>
JVM은 자바 프로그램에서 메소드가 호출되면, 메소드의 호출과 관계되는 지역 변수와 매개변수를 스택 영역에 저장합니다. 이렇게 스택 영역은 메소드의 호출과 함께 할당되며, 메소드의 호출이 완료되면 소멸합니다. 이렇게 스택 영역에 저장되는 메소드의 호출 정보를 스택 프레임(stack frame)이라고 합니다.
</p>
<p>
Frame은 메소드에 대한 정보를 가지고 있는 Local Variable, Operand Stack 그리고 Constant Pool Reference로 구성이 되어 있습니다. Local Variable은 메소드안의 지역 변수들을 가지고 있습니다. Operand Stack은 메소드 내 연산을 위해서, 바이트 코드 명령문들이 들어있는 공간입니다. Constant Pool Reference는 Constant Pool 참조를 위한 공간입니다.
</p>
<p>
스택  영역은 푸시(push) 동작으로 데이터를 저장하고, 팝(pop) 동작으로 데이터를 인출합니다.
</p>
<p>
또한 스택 영역의 경우 Heap 메모리 영역보다 비교적 빠르다는 장점이 있으며, 각각의 Thread 별로 메모리를 따로 할당하기 때문에 동시성 문제에서 자유롭다는 점이 있습니다.
</p>

